<ns0:RootFileSystem xmlns:ns0="https://www.linutronix.de/projects/Elbe" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" created="2009-05-20T08:50:56" revision="6" xsi:schemaLocation="https://www.linutronix.de/projects/Elbe dbsfed.xsd">
	<project>
		<name>qemu_aarch64</name>
		<version>1.0</version>
		<description>
			Use the following call to boot the image in qemu:
			$ qemu-system-aarch64 \
				-machine virt \
				-cpu cortex-a72 \
				-m 4096 \
				-nographic \
				-netdev user,id=mynet0,hostfwd=tcp::5555-:22 \
				-device virtio-net-pci,netdev=mynet0 \
				-kernel vmlinuz \
				-append "earlycon root=/dev/vda1" \
				-initrd initrd.img \
				-drive if=virtio,format=raw,file=sdcard.img
		</description>
		<buildtype>aarch64</buildtype>
		<mirror>
			<primary_host>ftp.de.debian.org</primary_host>
			<primary_path>/debian</primary_path>
			<primary_proto>http</primary_proto>
		</mirror>
		<suite>bookworm</suite>
	</project>
	<target>
		<hostname>qemu64</hostname>
		<domain></domain>
		<passwd>linux</passwd>
		<console>ttyAMA0,115200</console>
		<!-- speed up build with debootstrap variant minbase.
		Using minbase here and explicit install of systemd later
		on speed up the installation process, since it reduces
		the emulated part (run in QEMU) of the installation
		significant.
		-->
		<debootstrap>
			<variant>minbase</variant>
		</debootstrap>
		<images>
			<msdoshd>
				<name>sdcard.img</name>
				<size>2GB</size>
				<partition>
					<size>remain</size>
					<label>root</label>
					<bootable />
				</partition>
			</msdoshd>
		</images>
		<fstab>
			<bylabel>
				<label>root</label>
				<mountpoint>/</mountpoint>
				<fs>
					<type>ext4</type>
				</fs>
			</bylabel>
		</fstab>
		<install-recommends />
		<project-finetuning>
			<losetup img="sdcard.img">
				<!-- globs work, but must make sure, that only a single file is matched -->
				<copy_from_partition part="1" artifact="vmlinuz">/boot/vmlinuz-*-arm64</copy_from_partition>
				<copy_from_partition part="1" artifact="initrd.img">/boot/initrd.img-*-arm64</copy_from_partition>
			</losetup>
			<set_packer packer="none">sdcard.img</set_packer>
		</project-finetuning>
		<pkg-list>
			<pkg>linux-image-arm64</pkg>
			<pkg>systemd</pkg>
			<pkg>openssh-server</pkg>
			<pkg>iproute2</pkg>
		</pkg-list>
		<finetuning>
			<!-- Symlink systemd as init -->
			<command>ln -s /usr/lib/systemd/systemd /sbin/init</command>
			<!-- enable systemd-networkd -->
			<command>systemctl enable systemd-networkd</command>
		</finetuning>
	</target>
	<archivedir>overlays/networkd</archivedir>
	<archivedir>overlays/sshd</archivedir>
</ns0:RootFileSystem>
